/*
 * JSP generated by Resin-3.1.8 (built Mon, 17 Nov 2008 12:15:21 PST)
 */

package _jsp;
import javax.servlet.*;
import javax.servlet.jsp.*;
import javax.servlet.http.*;
import java.sql.*;
import java.io.*;
import java.util.*;
import java.lang.*;

public class _index__jsp extends com.caucho.jsp.JavaPage
{
  private static final java.util.HashMap<String,java.lang.reflect.Method> _jsp_functionMap = new java.util.HashMap<String,java.lang.reflect.Method>();
  private boolean _caucho_isDead;
  
  public void
  _jspService(javax.servlet.http.HttpServletRequest request,
              javax.servlet.http.HttpServletResponse response)
    throws java.io.IOException, javax.servlet.ServletException
  {
    javax.servlet.http.HttpSession session = request.getSession(true);
    com.caucho.server.webapp.WebApp _jsp_application = _caucho_getApplication();
    javax.servlet.ServletContext application = _jsp_application;
    com.caucho.jsp.PageContextImpl pageContext = _jsp_application.getJspApplicationContext().allocatePageContext(this, _jsp_application, request, response, null, session, 8192, true, false);
    javax.servlet.jsp.PageContext _jsp_parentContext = pageContext;
    javax.servlet.jsp.JspWriter out = pageContext.getOut();
    final javax.el.ELContext _jsp_env = pageContext.getELContext();
    javax.servlet.ServletConfig config = getServletConfig();
    javax.servlet.Servlet page = this;
    response.setContentType("text/html");
    response.setCharacterEncoding("UTF-8");
    request.setCharacterEncoding("UTF-8");
    try {
      out.write(_jsp_string0, 0, _jsp_string0.length);
      // by lydia Date 05/09/2008 Fix jsp file to support Thai language 
      out.write(_jsp_string1, 0, _jsp_string1.length);
      CP_Classes.Login logchk;
      synchronized (pageContext.getSession()) {
        logchk = (CP_Classes.Login) pageContext.getSession().getAttribute("logchk");
        if (logchk == null) {
          logchk = new CP_Classes.Login();
          pageContext.getSession().setAttribute("logchk", logchk);
        }
      }
      out.write(_jsp_string2, 0, _jsp_string2.length);
      CP_Classes.Translate trans;
      synchronized (pageContext.getSession()) {
        trans = (CP_Classes.Translate) pageContext.getSession().getAttribute("trans");
        if (trans == null) {
          trans = new CP_Classes.Translate();
          pageContext.getSession().setAttribute("trans", trans);
        }
      }
      out.write(_jsp_string2, 0, _jsp_string2.length);
      CP_Classes.Organization Org;
      synchronized (pageContext.getSession()) {
        Org = (CP_Classes.Organization) pageContext.getSession().getAttribute("Org");
        if (Org == null) {
          Org = new CP_Classes.Organization();
          pageContext.getSession().setAttribute("Org", Org);
        }
      }
      out.write(_jsp_string2, 0, _jsp_string2.length);
      CP_Classes.Create_Edit_Survey CE_Survey;
      synchronized (pageContext.getSession()) {
        CE_Survey = (CP_Classes.Create_Edit_Survey) pageContext.getSession().getAttribute("CE_Survey");
        if (CE_Survey == null) {
          CE_Survey = new CP_Classes.Create_Edit_Survey();
          pageContext.getSession().setAttribute("CE_Survey", CE_Survey);
        }
      }
      out.write(_jsp_string2, 0, _jsp_string2.length);
      CP_Classes.Setting server;
      synchronized (pageContext.getSession()) {
        server = (CP_Classes.Setting) pageContext.getSession().getAttribute("server");
        if (server == null) {
          server = new CP_Classes.Setting();
          pageContext.getSession().setAttribute("server", server);
        }
      }
      out.write(_jsp_string3, 0, _jsp_string3.length);
      
//Added by Xuehai, 08 Jun 2011. Include cookie to store the candidate value in the URL.
//The aim is, once the session expires, instead of showing the error page, it can redirect to the page user used to login.

      out.write(_jsp_string4, 0, _jsp_string4.length);
        //Store data from TB_Translation into Hashtable
trans.getTranslation();
if (request.getParameter("candidate") != null&&!(request.getParameter("candidate").equals("null")))
{
	
	String sOrg = request.getParameter("candidate");
	logchk.setOrgCode(sOrg);
	
	if(request.getParameter("org") != null)
	{
		sOrg = request.getParameter("org");
		logchk.setOrgCode(sOrg);
	}

	if(request.getParameter("admin") != null)
	{
		sOrg = request.getParameter("admin");
		logchk.setOrgCode(sOrg);
	}
	
	//Gwen Oh - 15/09/11: Set the organisation id
	int organisation = Org.getPKOrg(sOrg);
	logchk.setOrg(organisation);
	CE_Survey.set_survOrg(organisation);

      out.write(_jsp_string2, 0, _jsp_string2.length);
      
//Added by Xuehai, 08 Jun 2011. Store the candidate data in the cookie.
// So that the data can be used when session expires.

      out.write(_jsp_string5, 0, _jsp_string5.length);
      out.print((request.getParameter("candidate") ));
      out.write(_jsp_string6, 0, _jsp_string6.length);
      
if(logchk.getSystemMaintenance()==false) {

      out.write(_jsp_string7, 0, _jsp_string7.length);
      
}else{

      out.write(_jsp_string8, 0, _jsp_string8.length);
      
}
}
else
{
      out.write(_jsp_string9, 0, _jsp_string9.length);
      
//Added by Xuehai, 08 Jun 2011. Redirect to login page.

      out.write(_jsp_string10, 0, _jsp_string10.length);
       }
      out.write(_jsp_string11, 0, _jsp_string11.length);
    } catch (java.lang.Throwable _jsp_e) {
      pageContext.handlePageException(_jsp_e);
    } finally {
      _jsp_application.getJspApplicationContext().freePageContext(pageContext);
    }
  }

  private java.util.ArrayList _caucho_depends = new java.util.ArrayList();

  public java.util.ArrayList _caucho_getDependList()
  {
    return _caucho_depends;
  }

  public void _caucho_addDepend(com.caucho.vfs.PersistentDependency depend)
  {
    super._caucho_addDepend(depend);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  public boolean _caucho_isModified()
  {
    if (_caucho_isDead)
      return true;
    if (com.caucho.server.util.CauchoSystem.getVersionId() != 1886798272571451039L)
      return true;
    for (int i = _caucho_depends.size() - 1; i >= 0; i--) {
      com.caucho.vfs.Dependency depend;
      depend = (com.caucho.vfs.Dependency) _caucho_depends.get(i);
      if (depend.isModified())
        return true;
    }
    return false;
  }

  public long _caucho_lastModified()
  {
    return 0;
  }

  public java.util.HashMap<String,java.lang.reflect.Method> _caucho_getFunctionMap()
  {
    return _jsp_functionMap;
  }

  public void init(ServletConfig config)
    throws ServletException
  {
    com.caucho.server.webapp.WebApp webApp
      = (com.caucho.server.webapp.WebApp) config.getServletContext();
    super.init(config);
    com.caucho.jsp.TaglibManager manager = webApp.getJspApplicationContext().getTaglibManager();
    com.caucho.jsp.PageContextImpl pageContext = new com.caucho.jsp.PageContextImpl(webApp, this);
  }

  public void destroy()
  {
      _caucho_isDead = true;
      super.destroy();
  }

  public void init(com.caucho.vfs.Path appDir)
    throws javax.servlet.ServletException
  {
    com.caucho.vfs.Path resinHome = com.caucho.server.util.CauchoSystem.getResinHome();
    com.caucho.vfs.MergePath mergePath = new com.caucho.vfs.MergePath();
    mergePath.addMergePath(appDir);
    mergePath.addMergePath(resinHome);
    com.caucho.loader.DynamicClassLoader loader;
    loader = (com.caucho.loader.DynamicClassLoader) getClass().getClassLoader();
    String resourcePath = loader.getResourcePathSpecificFirst();
    mergePath.addClassPath(resourcePath);
    com.caucho.vfs.Depend depend;
    depend = new com.caucho.vfs.Depend(appDir.lookup("index.jsp"), -3729964517821234019L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  private final static char []_jsp_string9;
  private final static char []_jsp_string11;
  private final static char []_jsp_string8;
  private final static char []_jsp_string4;
  private final static char []_jsp_string6;
  private final static char []_jsp_string7;
  private final static char []_jsp_string3;
  private final static char []_jsp_string2;
  private final static char []_jsp_string10;
  private final static char []_jsp_string5;
  private final static char []_jsp_string1;
  private final static char []_jsp_string0;
  static {
    _jsp_string9 = "\r\n\r\n\r\n<body>\r\n<font face=\"Arial\" color=\"#FF0000\" size=\"2\"><b> </b>\r\n<font color=\"#FF0000\"><b>You are not authorised to view this page or Session Expired, please re-login!</b></font>\r\n<b><font color=\"#FF0000\"><a href=\"#\" onClick=\"toLogin();\">&nbsp;Login&nbsp;</a></font></b></font>\r\n	<p>&nbsp;</p>\r\n	<p>&nbsp;</p>\r\n	<p>&nbsp;</p>\r\n	<p>&nbsp;</p>\r\n	<p>&nbsp;</p>\r\n	<p>&nbsp;</p>\r\n	<p>&nbsp;</p>\r\n	<p>&nbsp;</p>\r\n	<p>&nbsp;</p>\r\n".toCharArray();
    _jsp_string11 = "\r\n</html>".toCharArray();
    _jsp_string8 = "\r\n<frameset framespacing=\"0\" border=\"0\" frameborder=\"0\" rows=\"126,357\">\r\n	<frame name=\"top\" scrolling=\"no\" noresize target=\"middle\" src=\"Top_maintenance.jsp\">\r\n	<frame name=\"middle\" src=\"Login_midpage_maintenance.jsp\" target=\"middle\" scrolling=\"auto\">\r\n		<noframes>\r\n	<body>\r\n\r\n	<p>This page uses frames, but your browser doesn't support them.</p>\r\n\r\n	</body>\r\n	</noframes>\r\n</frameset>\r\n".toCharArray();
    _jsp_string4 = "\r\n<script language=\"JavaScript\" type=\"text/javascript\">\r\n   function addCookie(objName,objValue,objHours){\r\n    var str = objName + \"=\" + escape(objValue);\r\n    if(objHours > 0){\r\n     var date = new Date();\r\n     var ms = objHours*3600*1000;\r\n     date.setTime(date.getTime() + ms);\r\n     str += \"; expires=\" + date.toGMTString();\r\n    }\r\n    document.cookie = str;\r\n   }\r\n  \r\n   function getCookie(objName){\r\n   try{\r\n    var arrStr = document.cookie.split(\"; \");\r\n    for(var i = 0;i < arrStr.length;i ++){\r\n     var temp = arrStr[i].split(\"=\");\r\n     if(temp[0] == objName) \r\n     	return unescape(temp[1]);\r\n    }\r\n    }catch(ex){}\r\n    return null;\r\n   }\r\n</script>\r\n\r\n</head>\r\n".toCharArray();
    _jsp_string6 = "';\r\n	addCookie(name, value, 24);\r\n}catch(ex){}\r\n</script>\r\n".toCharArray();
    _jsp_string7 = "\r\n<frameset framespacing=\"0\" border=\"0\" frameborder=\"0\" rows=\"126,357\">\r\n	<frame name=\"top\" scrolling=\"no\" noresize target=\"middle\" src=\"Top.jsp\">\r\n	<frame name=\"middle\" src=\"Login_midpage.jsp\" target=\"middle\" scrolling=\"auto\">\r\n		<noframes>\r\n	<body>\r\n\r\n	<p>This page uses frames, but your browser doesn't support them.</p>\r\n\r\n	</body>\r\n	</noframes>\r\n</frameset>\r\n".toCharArray();
    _jsp_string3 = "\r\n<html>\r\n\r\n<head>\r\n\r\n \r\n<title>3-Sixty Profiler Ver 1.3.15.50 </title>\r\n\r\n".toCharArray();
    _jsp_string2 = "\r\n".toCharArray();
    _jsp_string10 = "\r\n<script language=\"JavaScript\" type=\"text/javascript\">\r\nfunction toLogin(){\r\n	var value=getCookie('candidate');\r\n	if(value==null || value==''){\r\n		value='PCC';\r\n	}\r\n	window.location.href='index.jsp?candidate=' + value;\r\n}\r\n\r\nwindow.setTimeout(\"toLogin();\", 2000);\r\n</script>\r\n</body>\r\n\r\n".toCharArray();
    _jsp_string5 = "\r\n<script language=\"JavaScript\" type=\"text/javascript\">\r\ntry{\r\n	var name='candidate';\r\n	var value='".toCharArray();
    _jsp_string1 = "\r\n\r\n".toCharArray();
    _jsp_string0 = "\r\n\r\n \r\n\r\n\r\n".toCharArray();
  }
}
